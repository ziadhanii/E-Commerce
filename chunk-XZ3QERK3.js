import{a as E}from"./chunk-GE77HIRG.js";import{a as I,b as c,c as q,d as R,e as x,f as P,h as T,i as V,j as N,k as G,m as k}from"./chunk-LE4QMA67.js";import{i as y}from"./chunk-K5OTZUKN.js";import{Ab as g,Bc as S,Cb as v,Db as l,Ic as b,Mb as a,Nb as C,Pa as n,Va as h,_a as F,da as p,db as m,ea as w,ob as s,qb as f,vb as o,wb as r,xb as _}from"./chunk-NGFRSXTT.js";function M(t,i){t&1&&(o(0,"p"),a(1,"Email is required."),r())}function A(t,i){t&1&&(o(0,"p"),a(1,"Invalid email format."),r())}function j(t,i){if(t&1&&(o(0,"div",10),m(1,M,2,0,"p",11)(2,A,2,0,"p",11),r()),t&2){let e=l(2);n(),s("ngIf",e.email==null||e.email.errors==null?null:e.email.errors.required),n(),s("ngIf",e.email==null||e.email.errors==null?null:e.email.errors.email)}}function z(t,i){if(t&1&&(o(0,"p",12),a(1),r()),t&2){let e=l(2);n(),C(e.message)}}function B(t,i){if(t&1){let e=g();o(0,"section",1)(1,"form",2),v("ngSubmit",function(){p(e);let u=l();return w(u.onRequestResetPasswordFormSubmit())}),o(2,"h2",3),a(3,"Forget Password"),r(),o(4,"div",4)(5,"label",5),a(6,"Email"),r(),_(7,"input",6),m(8,j,3,2,"div",7),r(),o(9,"button",8),a(10,"Submit"),r(),m(11,z,2,1,"p",9),r()()}if(t&2){let e=l();n(),s("formGroup",e.requestResetPasswordForm),n(6),f("is-invalid",(e.email==null?null:e.email.invalid)&&((e.email==null?null:e.email.touched)||(e.email==null?null:e.email.dirty))),n(),s("ngIf",(e.email==null?null:e.email.invalid)&&((e.email==null?null:e.email.touched)||(e.email==null?null:e.email.dirty))),n(3),s("ngIf",e.message)}}function H(t,i){t&1&&(o(0,"p"),a(1,"Code is required."),r())}function J(t,i){if(t&1&&(o(0,"div",10),m(1,H,2,0,"p",11),r()),t&2){let e=l(2);n(),s("ngIf",e.resetCode==null||e.resetCode.errors==null?null:e.resetCode.errors.required)}}function K(t,i){if(t&1&&(o(0,"p",16),a(1),r()),t&2){let e=l(2);n(),C(e.message)}}function L(t,i){if(t&1){let e=g();o(0,"section",1)(1,"form",2),v("ngSubmit",function(){p(e);let u=l();return w(u.onVerifyCodeFormSubmit())}),o(2,"h2",3),a(3,"Verify Code"),r(),o(4,"div",4)(5,"label",13),a(6,"Code"),r(),_(7,"input",14),m(8,J,2,1,"div",7),r(),o(9,"button",8),a(10,"Submit"),r(),m(11,K,2,1,"p",15),r()()}if(t&2){let e=l();n(),s("formGroup",e.verifyCodeForm),n(6),f("is-invalid",(e.resetCode==null?null:e.resetCode.invalid)&&((e.resetCode==null?null:e.resetCode.touched)||(e.resetCode==null?null:e.resetCode.dirty))),n(),s("ngIf",(e.resetCode==null?null:e.resetCode.invalid)&&((e.resetCode==null?null:e.resetCode.touched)||(e.resetCode==null?null:e.resetCode.dirty))),n(3),s("ngIf",e.message)}}function O(t,i){t&1&&(o(0,"p"),a(1,"Password is required."),r())}function Q(t,i){if(t&1&&(o(0,"div",10),m(1,O,2,0,"p",11),r()),t&2){let e=l(2);n(),s("ngIf",e.newPassword==null||e.newPassword.errors==null?null:e.newPassword.errors.required)}}function U(t,i){if(t&1&&(o(0,"p",16),a(1),r()),t&2){let e=l(2);n(),C(e.message)}}function W(t,i){if(t&1){let e=g();o(0,"section",1)(1,"form",2),v("ngSubmit",function(){p(e);let u=l();return w(u.onResetPasswordFormSubmit())}),o(2,"h2",3),a(3,"Reset Password"),r(),o(4,"div",4)(5,"label",17),a(6,"New Password"),r(),_(7,"input",18),m(8,Q,2,1,"div",7),r(),o(9,"button",8),a(10,"Submit"),r(),m(11,U,2,1,"p",15),r()()}if(t&2){let e=l();n(),s("formGroup",e.resetPasswordForm),n(6),f("is-invalid",(e.newPassword==null?null:e.newPassword.invalid)&&((e.newPassword==null?null:e.newPassword.touched)||(e.newPassword==null?null:e.newPassword.dirty))),n(),s("ngIf",(e.newPassword==null?null:e.newPassword.invalid)&&((e.newPassword==null?null:e.newPassword.touched)||(e.newPassword==null?null:e.newPassword.dirty))),n(3),s("ngIf",e.message)}}var D=class t{constructor(i,e){this.authService=i;this.router=e}requestResetPassword=!0;verifyCode=!1;resetPassword=!1;message="";savedEmail="";requestResetPasswordForm=new x({email:new P("",[c.required,c.email])});verifyCodeForm=new x({resetCode:new P("",[c.required])});resetPasswordForm=new x({newPassword:new P("",[c.required])});onRequestResetPasswordFormSubmit(){if(this.requestResetPasswordForm.invalid)return;let i=this.requestResetPasswordForm.value.email;this.savedEmail=i,this.authService.requestResetPassword(i).subscribe({next:e=>{console.log(e),e.statusMsg==="success"&&(this.message=e.message),this.requestResetPassword=!1,this.verifyCode=!0,this.resetPassword=!1},error:e=>{this.message=e.error.message}})}onVerifyCodeFormSubmit(){let i=this.verifyCodeForm.value.resetCode.trim();this.authService.verifyResetCode(i).subscribe({next:e=>{console.log(e),e.status==="success"&&(this.message=e.status),this.requestResetPassword=!1,this.verifyCode=!1,this.resetPassword=!0},error:e=>{this.message=e.error.message}})}onResetPasswordFormSubmit(){let i=this.resetPasswordForm.value.newPassword;this.authService.resetPassword(this.savedEmail,i).subscribe({next:e=>{console.log(e),e?.token&&(localStorage.setItem("token",e.token),this.router.navigate(["/home"]),this.message=e.message),this.requestResetPassword=!0,this.verifyCode=!1,this.resetPassword=!1},error:e=>{this.message=e.error.message}})}get email(){return this.requestResetPasswordForm.get("email")}get resetCode(){return this.verifyCodeForm.get("resetCode")}get newPassword(){return this.resetPasswordForm.get("newPassword")}static \u0275fac=function(e){return new(e||t)(h(E),h(y))};static \u0275cmp=F({type:t,selectors:[["app-forget-password"]],decls:3,vars:3,consts:[["class","container my-5 p-4 rounded bg-light shadow-sm",4,"ngIf"],[1,"container","my-5","p-4","rounded","bg-light","shadow-sm"],[3,"ngSubmit","formGroup"],[1,"mb-4"],[1,"mb-3"],["for","email",1,"form-label"],["formControlName","email","type","email","id","email","name","email","placeholder","Enter your email","required","",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["type","submit",1,"btn","main-btn","w-100","mt-3"],["class","alert alert-danger w-75 mx-auto p-1 m-4",4,"ngIf"],[1,"invalid-feedback"],[4,"ngIf"],[1,"alert","alert-danger","w-75","mx-auto","p-1","m-4"],["for","code",1,"form-label"],["formControlName","resetCode","type","text","id","code","name","code","placeholder","Enter your code","required","",1,"form-control"],["class","alert alert-danger w-75 mx-auto p-1 mb-0",4,"ngIf"],[1,"alert","alert-danger","w-75","mx-auto","p-1","mb-0"],["for","password",1,"form-label"],["formControlName","newPassword","type","password","id","password","name","password","placeholder","Enter your new password","required","",1,"form-control"]],template:function(e,d){e&1&&m(0,B,12,5,"section",0)(1,L,12,5,"section",0)(2,W,12,5,"section",0),e&2&&(s("ngIf",d.requestResetPassword),n(),s("ngIf",d.verifyCode),n(),s("ngIf",d.resetPassword))},dependencies:[b,S,k,T,I,q,R,G,V,N],encapsulation:2})};export{D as ForgetPasswordComponent};
