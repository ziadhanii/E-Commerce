import{a as V}from"./chunk-OQWNX35X.js";import{a as N}from"./chunk-5LMONJHZ.js";import{l as $}from"./chunk-V663ZQKE.js";import{a as j}from"./chunk-MHDMHZ4C.js";import{j as P}from"./chunk-K5OTZUKN.js";import{Ab as y,Bc as F,Cb as f,Db as d,Gb as W,Ic as k,La as w,Lb as L,Mb as o,Nb as x,Ob as _,Pa as s,Va as l,Vb as E,_a as g,_b as I,ac as D,cc as T,da as h,db as S,ea as u,ob as m,tb as b,ub as C,vb as r,wb as n,xb as v}from"./chunk-NGFRSXTT.js";var A=i=>["/productdetails",i],M=(i,e)=>e==null?null:e._id;function R(i,e){if(i&1){let t=y();r(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),v(4,"img",8),n(),r(5,"div",9)(6,"h5",10),o(7),I(8,"cuttext"),n(),r(9,"div",11),v(10,"i",12),r(11,"span"),o(12),n()(),r(13,"div",13)(14,"span",14),o(15),n(),r(16,"span",15),o(17),n()()()(),r(18,"div",16)(19,"button",17),f("click",function(){let c=h(t).$implicit,p=d(2);return u(p.addProductToCart(c._id))}),o(20,"Add To Cart"),n(),r(21,"button",18),f("click",function(){let c=h(t).$implicit,p=d(2);return u(p.deleteProductFromWishlist(c._id))}),o(22,"Delete"),n()()()()}if(i&2){let t=e.$implicit;s(2),m("routerLink",E(10,A,t._id)),s(2),W("alt",t.title),m("src",t.imageCover,w),s(3),x(D(8,7,t.title,3)),s(5),x(t.ratingsAverage),s(3),_("$",t.price,""),s(2),_("$",t.price+100,"")}}function U(i,e){if(i&1&&(r(0,"div")(1,"div",3),b(2,R,23,12,"div",4,M),n()()),i&2){let t=d();s(2),C(t.wishListData)}}function z(i,e){i&1&&(r(0,"div",19)(1,"h3",20),o(2,"Your Wishlist is empty"),n(),r(3,"p"),o(4,"Add some products to your wishlist to see them here."),n()())}var O=class i{constructor(e,t,a){this.wishlistService=e;this.cartService=t;this.toastr=a}wishListData=[];ngOnInit(){this.displayWishListData()}displayWishListData(){this.wishlistService.getWishlist().subscribe({next:e=>{this.wishListData=e?.data??[],this.wishlistService.wishListNumber.next(this.wishListData.length)},error:e=>{console.error("Error fetching wishlist data:",e),this.toastr.error("Failed to load wishlist.","Error"),this.wishListData=[]}})}addProductToCart(e){this.cartService.addToCart(e).subscribe({next:t=>{this.toastr.success(t.message||"Product added to cart!"),this.cartService.getLoggedUserCart().subscribe({next:a=>{this.cartService.cartNumber.next(a?.numOfCartItems||0)},error:()=>{console.error("Failed to fetch cart items count.")}}),this.deleteProductFromWishlist(e)},error:t=>{this.toastr.error("Failed to add product to cart."),console.error(t)}})}deleteProductFromWishlist(e){this.wishlistService.removeFromWishlist(e).subscribe({next:t=>{this.toastr.success(t.message||"Product removed from wishlist."),this.wishListData=this.wishListData.filter(a=>a.id!==e),this.wishlistService.wishListNumber.next(this.wishListData.length)},error:t=>{this.toastr.error("Failed to remove product from wishlist."),console.error(t)}})}static \u0275fac=function(t){return new(t||i)(l(N),l(j),l($))};static \u0275cmp=g({type:i,selectors:[["app-wishlist"]],decls:4,vars:2,consts:[["emptyWishlist",""],[1,"container","py-4"],[4,"ngIf","ngIfElse"],[1,"row","g-3"],[1,"col-xl-3","col-lg-4","col-md-6","col-sm-12"],[1,"card","bg-light","rounded-3","p-3","h-100","d-flex","flex-column","justify-content-between"],[1,"cursor-pointer",3,"routerLink"],[1,"image"],[1,"w-100","rounded-3",3,"src","alt"],[1,"content","mt-3"],[1,"text-truncate"],[1,"d-flex","align-items-center","mt-2"],[1,"fa","fa-star","text-warning","me-1"],[1,"d-flex","justify-content-between","align-items-center","mt-2"],[1,"price","fw-bold","text-success"],[1,"sale","text-muted","text-decoration-line-through"],[1,"d-flex","justify-content-between","mt-3"],[1,"btn","btn-sm","btn-outline-secondary","w-50",3,"click"],[1,"btn","btn-sm","btn-outline-danger","w-50","ms-2",3,"click"],[1,"text-center","py-5"],[1,"text-muted"]],template:function(t,a){if(t&1&&(r(0,"div",1),S(1,U,4,0,"div",2)(2,z,5,0,"ng-template",null,0,T),n()),t&2){let c=L(3);s(),m("ngIf",a.wishListData.length>0)("ngIfElse",c)}},dependencies:[P,k,F,V],encapsulation:2})};export{O as WishlistComponent};
