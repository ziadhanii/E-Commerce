import{a as R}from"./chunk-DZXZPCOG.js";import{i as V}from"./chunk-TLZ2ZCQ4.js";import{Ab as C,Ac as k,Bc as D,Cb as p,Db as s,Ic as T,La as w,Lb as v,Mb as a,Nb as h,Ob as y,Pa as d,Ua as S,Va as f,_a as E,cc as I,da as l,db as x,ea as m,ob as g,vb as r,wb as o,xb as b}from"./chunk-BLPEOKRJ.js";function j(c,t){if(c&1){let e=C();r(0,"div",17)(1,"div",18),b(2,"img",19),o(),r(3,"div",20)(4,"div")(5,"h3",21),a(6),o(),r(7,"p",22),a(8),o(),r(9,"button",23,1),p("click",function(){let i=l(e).$implicit,u=v(10),_=s(2);return m(_.removeItem(i.product._id,u))}),b(11,"i",24),a(12," Remove "),o()(),r(13,"div",25)(14,"button",26,1),p("click",function(){let i=l(e).$implicit,u=v(10),_=s(2);return m(_.changeCount(i.count-1,i.product._id,u))}),a(16,"-"),o(),r(17,"span",27),a(18),o(),r(19,"button",26,2),p("click",function(){let i=l(e).$implicit,u=v(20),_=s(2);return m(_.changeCount(i.count+1,i.product._id,u))}),a(21,"+"),o()()()()}if(c&2){let e=t.$implicit;d(2),g("src",e.product.imageCover,w)("alt",e.product.title),d(4),h(e.product.title),d(2),y("Price: ",e.price," EGP "),d(10),h(e.count)}}function O(c,t){if(c&1){let e=C();r(0,"section",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"h1",8),a(5,"Shop Cart"),o(),r(6,"button",9),p("click",function(){l(e);let i=s();return m(i.clearCart())}),a(7,"Clear Cart"),o()(),r(8,"p",10),a(9),o(),x(10,j,22,5,"div",11),r(11,"div",12)(12,"button",13),p("click",function(){l(e);let i=s();return m(i.navigateToPayment("card"))}),b(13,"img",14),r(14,"span"),a(15,"Online Payment"),o()(),r(16,"button",15),p("click",function(){l(e);let i=s();return m(i.navigateToPayment("cash"))}),b(17,"img",16),r(18,"span"),a(19,"Cash On Delivery"),o()()()()()()}if(c&2){let e=s();d(9),y("Total Price: ",e.cartDetails.totalCartPrice," EGP "),d(),g("ngForOf",e.cartDetails.products)}}function A(c,t){c&1&&(r(0,"div",28)(1,"h2"),a(2,"Your Cart is Empty"),o()())}var P=class c{constructor(t,e,n){this.cartService=t;this.renderer=e;this.router=n}cartDetails=null;ngOnInit(){this.cartService.getLoggedUserCart().subscribe({next:t=>{this.cartDetails=t.data}})}removeItem(t,e){this.renderer.setAttribute(e,"disabled","true"),this.cartService.removeFromCart(t).subscribe({next:n=>{this.cartDetails=n.data,this.renderer.removeAttribute(e,"disabled"),this.cartService.cartNumber.next(n.numOfCartItems)},error:n=>{this.renderer.removeAttribute(e,"disabled")}})}changeCount(t,e,n){t>=1&&(this.renderer.setAttribute(n,"disabled","true"),this.cartService.updateCartCount(e,t).subscribe({next:i=>{console.log(i),this.cartDetails=i.data,this.renderer.removeAttribute(n,"disabled")},error:i=>{this.renderer.removeAttribute(n,"disabled")}}))}clearCart(){this.cartService.clearCart().subscribe({next:t=>{t.message==="success"&&(this.cartDetails=null,this.cartService.cartNumber.next(0))},error:t=>{console.log(t)}})}navigateToPayment(t){this.cartDetails?._id?this.router.navigate(["/payment",this.cartDetails._id],{queryParams:{paymentMethod:t}}):console.error("Cart ID is missing")}static \u0275fac=function(e){return new(e||c)(f(R),f(S),f(V))};static \u0275cmp=E({type:c,selectors:[["app-cart"]],decls:3,vars:2,consts:[["emptyCart",""],["btnRemove",""],["btnAdd",""],["class","container-fluid py-3 mb-5",4,"ngIf","ngIfElse"],[1,"container-fluid","py-3","mb-5"],[1,"row","justify-content-center"],[1,"col-12","col-md-10","col-lg-8","bg-main-light","rounded","shadow","p-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"h3"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"text-main","fw-bold"],["class","row border-bottom py-3 align-items-center",4,"ngFor","ngForOf"],[1,"d-flex","gap-3","mt-4","justify-content-center"],[1,"btn","main-btn","d-flex","justify-content-center","align-items-center","gap-2","px-4","py-2","rounded-pill","fw-bold","w-50","text-center",3,"click"],["src","assets/images/visa-1.svg","alt","visa-img",1,"visa-img"],[1,"btn","btn-primary","d-flex","justify-content-center","align-items-center","gap-2","px-4","py-2","rounded-pill","fw-bold","w-50","text-center",3,"click"],["src","assets/images/icons8-cash-80.png","alt","cash-img",1,"visa-img",2,"width","25px","height","25px"],[1,"row","border-bottom","py-3","align-items-center"],[1,"col-3","col-sm-2"],[1,"img-fluid","rounded",3,"src","alt"],[1,"col-9","col-sm-10","d-flex","justify-content-between","align-items-center"],[1,"h6","mb-1"],[1,"text-main","small"],[1,"btn","m-0","p-0","text-main","border-0",3,"click"],[1,"fas","fa-trash-can"],[1,"d-flex","align-items-center"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"mx-2"],[1,"text-center","py-5"]],template:function(e,n){if(e&1&&x(0,O,20,2,"section",3)(1,A,3,0,"ng-template",null,0,I),e&2){let i=v(2);g("ngIf",(n.cartDetails==null||n.cartDetails.products==null?null:n.cartDetails.products.length)>0)("ngIfElse",i)}},dependencies:[T,k,D],encapsulation:2})};export{P as CartComponent};
